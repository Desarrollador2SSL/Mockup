<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cuadro Comparativo - SSL v4.0</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Archivo CSS del menú separado -->
    <link rel="stylesheet" href="../css/menu-styles.css">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #667eea;
            --accent-color: #764ba2;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --error-color: #e74c3c;
            --info-color: #17a2b8;
            --text-color: #333;
            --text-light: #ecf0f1;
            --border-color: #ddd;
            --hover-color: #5a52d5;
            --active-color: #4a42b5;
            --menu-width: 260px;
            --menu-collapsed-width: 70px;
            --header-height: 65px;
            --transition-speed: 0.3s;
            --card-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
            --hover-shadow: 0 5px 20px rgba(0, 0, 0, 0.12);
            --best-price: #d1fae5;
            --incomplete: #fef3c7;
            --selected: #e0e7ff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f8f9fa;
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* Header */
        .header {
            background-color: white;
            color: var(--text-color);
            height: var(--header-height);
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo img {
            height: 40px;
        }

        .logo-text {
            display: flex;
            flex-direction: column;
        }

        .logo h1 {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--primary-color);
        }

        .portal-type {
            font-size: 0.8rem;
            color: var(--secondary-color);
            font-weight: 500;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .header-date {
            display: flex;
            align-items: center;
            font-size: 0.9rem;
            color: var(--text-color);
            padding: 0 15px;
            border-right: 1px solid var(--border-color);
            height: 35px;
        }

        .header-date i {
            margin-right: 8px;
            color: var(--secondary-color);
        }

        .notifications {
            position: relative;
        }

        .notifications-button {
            background: none;
            border: none;
            font-size: 1.2rem;
            color: var(--text-color);
            cursor: pointer;
            padding: 8px;
            position: relative;
            transition: color var(--transition-speed);
        }

        .notifications-button:hover {
            color: var(--secondary-color);
        }

        .notification-badge {
            position: absolute;
            top: 0;
            right: 0;
            background: linear-gradient(135deg, var(--secondary-color), var(--accent-color));
            color: white;
            border-radius: 50%;
            font-size: 0.7rem;
            min-width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .user-menu {
            display: flex;
            align-items: center;
            cursor: pointer;
            position: relative;
            padding: 8px 12px;
            border-radius: 25px;
            transition: background-color var(--transition-speed);
            background-color: #f8f9fa;
        }

        .user-menu:hover {
            background-color: #e9ecef;
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--secondary-color), var(--accent-color));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            margin-right: 10px;
            font-weight: bold;
        }

        .user-name {
            font-weight: 500;
            margin-right: 8px;
            color: var(--text-color);
        }

        .user-menu-arrow {
            font-size: 0.8rem;
            color: var(--text-color);
            transition: transform var(--transition-speed);
        }

        .user-menu.active .user-menu-arrow {
            transform: rotate(180deg);
        }

        /* Dropdown menu */
        .user-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            min-width: 220px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all var(--transition-speed);
            overflow: hidden;
        }

        .user-menu.active .user-dropdown {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .dropdown-header {
            padding: 15px 20px;
            border-bottom: 1px solid var(--border-color);
            background-color: #f8f9fa;
        }

        .dropdown-user-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .dropdown-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--secondary-color), var(--accent-color));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }

        .dropdown-user-details {
            flex: 1;
        }

        .dropdown-user-name {
            font-weight: 600;
            color: var(--text-color);
            font-size: 0.95rem;
        }

        .dropdown-user-email {
            font-size: 0.85rem;
            color: #666;
        }

        .dropdown-menu {
            padding: 8px 0;
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: var(--text-color);
            text-decoration: none;
            transition: background-color var(--transition-speed);
            cursor: pointer;
        }

        .dropdown-item:hover {
            background-color: #f8f9fa;
        }

        .dropdown-item i {
            margin-right: 12px;
            width: 20px;
            text-align: center;
            color: #666;
        }

        .dropdown-divider {
            height: 1px;
            background-color: var(--border-color);
            margin: 8px 0;
        }

        .dropdown-item.logout {
            color: var(--error-color);
        }

        .dropdown-item.logout i {
            color: var(--error-color);
        }

        /* Container */
        .container {
            display: flex;
            flex: 1;
            margin-top: var(--header-height);
        }

        /* Content */
        .content {
            flex: 1;
            padding: 30px;
            background-color: #f8f9fa;
            min-height: calc(100vh - var(--header-height));
            transition: margin-left var(--transition-speed);
        }

        /* Breadcrumb */
        .breadcrumb {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            font-size: 0.9rem;
            background-color: white;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: var(--card-shadow);
        }

        .breadcrumb-item {
            display: inline-block;
            color: var(--text-color);
        }

        .breadcrumb-item a {
            color: var(--secondary-color);
            text-decoration: none;
            transition: color var(--transition-speed);
        }

        .breadcrumb-item a:hover {
            color: var(--hover-color);
        }

        .breadcrumb-item:not(:last-child)::after {
            content: "/";
            margin: 0 10px;
            color: #aaa;
        }

        .breadcrumb-item.active {
            color: var(--text-color);
            font-weight: 500;
        }

        /* Page Title */
        .page-title {
            font-size: 1.8rem;
            margin-bottom: 30px;
            color: var(--primary-color);
            font-weight: 600;
        }

        /* Cards */
        .card {
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: var(--card-shadow);
            margin-bottom: 25px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .card-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--primary-color);
        }

        /* Status Badge */
        .status-badge {
            display: inline-flex;
            align-items: center;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .status-pending {
            background-color: #fef3c7;
            color: #78350f;
        }

        .status-complete {
            background-color: #d1fae5;
            color: #064e3b;
        }

        .status-draft {
            background-color: #e0e7ff;
            color: #3730a3;
        }

        .status-recommendation {
            background-color: #ddd6fe;
            color: #5b21b6;
        }

        /* Info Grid */
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .info-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .info-label {
            font-weight: 600;
            color: var(--text-color);
            min-width: 100px;
        }

        .info-value {
            color: #666;
        }

        /* Alert */
        .alert {
            display: flex;
            align-items: center;
            padding: 15px;
            background-color: #e0e7ff;
            border-left: 4px solid var(--secondary-color);
            border-radius: 4px;
            margin-bottom: 20px;
        }

        .alert i {
            color: var(--secondary-color);
            margin-right: 10px;
            font-size: 1.2rem;
        }

        /* View Controls */
        .view-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .view-btn {
            padding: 8px 16px;
            border: 1px solid var(--border-color);
            background-color: white;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all var(--transition-speed);
            font-weight: 500;
        }

        .view-btn:hover {
            background-color: #f8f9fa;
            border-color: var(--secondary-color);
            color: var(--secondary-color);
        }

        .view-btn.active {
            background: linear-gradient(135deg, var(--secondary-color), var(--accent-color));
            color: white;
            border-color: transparent;
        }

        /* Filter Section */
        .filter-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .filter-group label {
            font-weight: 500;
            font-size: 0.9rem;
            color: var(--text-color);
        }

        .filter-control {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: white;
            transition: all var(--transition-speed);
        }

        .filter-control:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        /* Provider Summary */
        .provider-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .provider-card {
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px;
            background-color: white;
            transition: all var(--transition-speed);
        }

        .provider-card:hover {
            border-color: var(--secondary-color);
            box-shadow: var(--hover-shadow);
            transform: translateY(-2px);
        }

        .provider-card.recommended {
            border-color: var(--success-color);
            background-color: #f0fdf4;
        }

        .provider-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .provider-name {
            font-weight: 600;
            color: var(--primary-color);
            font-size: 1.1rem;
        }

        .recommended-badge {
            background: linear-gradient(135deg, var(--success-color), #16a34a);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .provider-details {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
        }

        .detail-label {
            color: #666;
        }

        .detail-value {
            font-weight: 600;
            color: var(--text-color);
        }

        /* Comparison Table */
        .table-container {
            overflow-x: auto;
            border: 1px solid var(--border-color);
            border-radius: 10px;
            background-color: white;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .comparison-table th {
            background-color: #f9fafb;
            font-weight: 600;
            color: var(--primary-color);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .comparison-table tbody tr:hover {
            background-color: #f9fafb;
        }

        .product-group {
            background-color: #e5e7eb;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.5px;
        }

        .product-code {
            font-family: monospace;
            font-size: 0.9rem;
            color: var(--secondary-color);
        }

        .price-cell {
            text-align: right;
            font-weight: 500;
        }

        .best-price {
            background-color: var(--best-price) !important;
            font-weight: 600;
        }

        .price-variation {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            font-size: 0.75rem;
            margin-top: 4px;
        }

        .variation-up {
            color: var(--error-color);
        }

        .variation-down {
            color: var(--success-color);
        }

        .variation-equal {
            color: #6b7280;
        }

        .checkbox-cell {
            text-align: center;
            position: relative;
        }

        .checkbox-cell.has-selection::after {
            content: '✓';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: var(--success-color);
            font-size: 1.2rem;
            font-weight: bold;
            pointer-events: none;
            margin-left: 25px;
        }

        .provider-checkbox {
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: var(--secondary-color);
        }

        .provider-radio {
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: var(--secondary-color);
        }

        .provider-radio:disabled {
            cursor: not-allowed;
            opacity: 0.5;
        }

        /* Highlight selected provider cells */
        .comparison-table td.selected-provider {
            background-color: rgba(224, 231, 255, 0.5) !important;
            font-weight: 600;
        }

        .unit-normalized {
            display: inline-flex;
            align-items: center;
            padding: 2px 8px;
            background-color: #e0e7ff;
            border-radius: 12px;
            font-size: 0.75rem;
            margin-left: 8px;
            color: var(--secondary-color);
        }

        .incomplete-quote {
            background-color: var(--incomplete);
        }

        .no-quote {
            text-align: center;
            color: var(--error-color);
            font-style: italic;
        }

        /* Totals */
        .comparison-table tfoot {
            font-weight: 600;
        }

        .comparison-table tfoot tr {
            background-color: #f9fafb;
        }

        .comparison-table tfoot tr:last-child {
            background: linear-gradient(to right, #e0e7ff, #f0e6ff);
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 25px;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all var(--transition-speed);
            font-size: 0.95rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--secondary-color), var(--accent-color));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success-color), #16a34a);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.3);
        }

        .btn-outline {
            background-color: white;
            border: 2px solid var(--border-color);
            color: var(--text-color);
        }

        .btn-outline:hover {
            background-color: #f8f9fa;
            border-color: var(--secondary-color);
            color: var(--secondary-color);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            animation: fadeIn 0.3s;
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 12px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border-color);
        }

        .modal-title {
            font-size: 1.5rem;
            color: var(--primary-color);
            font-weight: 600;
        }

        .close {
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color var(--transition-speed);
        }

        .close:hover {
            color: var(--text-color);
        }

        /* Tooltips */
        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: var(--primary-color);
            color: white;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.85rem;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        /* Help Button */
        .help-button-container {
            margin: 0 15px;
        }

        .help-button {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 8px 16px;
            background-color: var(--secondary-color);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all var(--transition-speed);
            position: relative;
        }

        .help-button:hover {
            background-color: var(--hover-color);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .help-button i {
            font-size: 1.1rem;
        }

        .help-text {
            display: inline-block;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .user-name {
                display: none;
            }

            .header-date {
                display: none;
            }

            .info-grid {
                grid-template-columns: 1fr;
            }

            .provider-summary {
                grid-template-columns: 1fr;
            }

            .filter-section {
                grid-template-columns: 1fr;
            }

            .table-container {
                overflow-x: auto;
            }

            .comparison-table {
                min-width: 1200px;
            }

            .action-buttons {
                flex-direction: column;
            }

            .btn-group {
                width: 100%;
                justify-content: center;
            }

            .help-text {
                display: none;
            }
            
            .help-button {
                padding: 8px 12px;
            }                
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-left">
            <div class="menu-toggle" onclick="toggleMobileMenu()">
                <i class="fas fa-bars"></i>
            </div>
            <div class="logo">
                <img src="../PagWebLocal/logo_ssl.png" alt="SSL Logo">
                <div class="logo-text">
                    <h1>SSL v4.0</h1>
                    <span class="portal-type">Portal Cliente</span>
                </div>
            </div>
        </div>
        
        <div class="header-right">
            <div class="header-date">
                <i class="fas fa-calendar-alt"></i>
                <span id="currentDate">Cargando...</span>
            </div>
            
            <!-- AGREGAR ESTE BOTÓN DE AYUDA -->
            <div class="help-button-container">
                <a href="../cliente_navegacion.html" class="help-button" title="Ayuda y Navegación">
                    <i class="fas fa-question-circle"></i>
                    <span class="help-text">Ayuda</span>
                </a>
            </div>

            <div class="notifications">
                <button class="notifications-button" onclick="showNotifications()">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge">3</span>
                </button>
            </div>
            
            <div class="user-menu" id="userMenu">
                <div class="user-avatar">
                    <i class="fas fa-building"></i>
                </div>
                <span class="user-name" id="userName">Empresa Demo S.A.</span>
                <i class="fas fa-chevron-down user-menu-arrow"></i>
                
                <div class="user-dropdown">
                    <div class="dropdown-header">
                        <div class="dropdown-user-info">
                            <div class="dropdown-avatar">
                                <i class="fas fa-building"></i>
                            </div>
                            <div class="dropdown-user-details">
                                <div class="dropdown-user-name" id="dropdownUserName">Empresa Demo S.A.</div>
                                <div class="dropdown-user-email" id="dropdownUserEmail">cliente@demo.com</div>
                            </div>
                        </div>
                    </div>
                    <div class="dropdown-menu">
                        <a href="#" class="dropdown-item" onclick="goToProfile(event)">
                            <i class="fas fa-user-circle"></i>
                            <span>Mi Perfil</span>
                        </a>
                        <a href="#" class="dropdown-item" onclick="goToSettings(event)">
                            <i class="fas fa-cog"></i>
                            <span>Configuración</span>
                        </a>
                        <div class="dropdown-divider"></div>
                        <a href="#" class="dropdown-item logout" onclick="logout(event)">
                            <i class="fas fa-sign-out-alt"></i>
                            <span>Cerrar Sesión</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="container">

        <!-- Solicitudes de Pedido   -->
        <nav class="sidebar" id="sidebar">
            <ul class="menu">
                <!-- Dashboard -->
                <li class="menu-item">
                    <div class="menu-header" onclick="toggleSubmenu(this)">
                        <i class="fas fa-home"></i>
                        <span>Dashboard</span>
                        <div class="menu-tooltip">Dashboard</div>
                    </div>
                </li>

                <!-- Central de Mensajería -->
                <li class="menu-item">
                    <div class="menu-header" onclick="window.location.href='../cliente_mensajeria/cliente_listado_mensajeria.html'">
                        <i class="fas fa-comments"></i>
                        <span>Central de Mensajería</span>
                        <div class="menu-tooltip">Central de Mensajería</div>
                    </div>
                </li>

                <!-- Solicitudes y Cotizaciones -->
                <li class="menu-item active">
                    <div class="menu-header active" onclick="toggleSubmenu(this)">
                        <i class="fas fa-file-alt"></i>
                        <span>Cotización y Compra</span>
                        <i class="fas fa-chevron-right arrow"></i>
                        <div class="menu-tooltip">Cotización y Compra</div>
                    </div>
                    <div class="submenu">
                        <a href="cliente_listado_solicitudes.html" class="submenu-item active">
                            <span class="full-text">Solicitudes de Pedido</span>
                            <span class="siglas">SP</span>
                            <div class="sigla-tooltip">Solicitudes de Pedido</div>
                        </a>
                        <a href="../cliente_cotizaciones/cliente_listado_cotizaciones.html" class="submenu-item">
                            <span class="full-text">Cotizaciones</span>
                            <span class="siglas">CO</span>
                            <div class="sigla-tooltip">Cotizaciones</div>
                        </a>
                        <a href="../cliente_orden_compra/cliente_listado_ordenes_compra.html" class="submenu-item">
                            <span class="full-text">Órdenes de Compra</span>
                            <span class="siglas">OC</span>
                            <div class="sigla-tooltip">Órdenes de Compra</div>
                        </a>
                    </div>
                </li>

                <!-- Control de Entregas -->
                <li class="menu-item">
                    <div class="menu-header" onclick="toggleSubmenu(this)">
                        <i class="fas fa-truck"></i>
                        <span>Control de Entregas</span>
                        <i class="fas fa-chevron-right arrow"></i>
                        <div class="menu-tooltip">Control de Entregas</div>
                    </div>
                    <div class="submenu">
                        <a href="../cliente_control_entrega/cliente_listado_control_entregas.html" class="submenu-item">
                            <span class="full-text">Control Entrega por OC</span>
                            <span class="siglas">CEO</span>
                            <div class="sigla-tooltip">Control Entrega por OC</div>
                        </a>

                        <a href="../cliente_modificaciones/cliente_listado_modificaciones.html" class="submenu-item">
                            <span class="full-text">Modificaciones OC</span>
                            <span class="siglas">MOC</span>
                            <div class="sigla-tooltip">Modificaciones OC</div>
                        </a>

                        <a href="../cliente_control_recepcion/cliente_listado_despachos.html" class="submenu-item">
                            <span class="full-text">Control Recepción</span>
                            <span class="siglas">CRE</span>
                            <div class="sigla-tooltip">Control Recepción</div>
                        </a>

                        <a href="../cliente_incidentes/cliente_listado_incidentes.html" class="submenu-item">
                            <span class="full-text">Incidentes de Entrega</span>
                            <span class="siglas">IEN</span>
                            <div class="sigla-tooltip">Incidentes de Entrega</div>
                        </a>                        
                    </div>
                </li>
               
                <!-- Pagos -->
                <li class="menu-item">
                    <div class="menu-header" onclick="toggleSubmenu(this)">
                        <i class="fas fa-file-invoice-dollar"></i>
                        <span>Pagos</span>
                        <i class="fas fa-chevron-right arrow"></i>
                        <div class="menu-tooltip">Pagos</div>
                    </div>
                    <div class="submenu">
                        <a href="../cliente_pagos/cliente_listado_pagos.html" class="submenu-item">
                            <span class="full-text">Estado de Pagos</span>
                            <span class="siglas">EP</span>
                            <div class="sigla-tooltip">Estado de Pagos</div>
                        </a>                          
                    </div>
                </li>

                <!-- Control Total de Obras -->
                <li class="menu-item">
                    <div class="menu-header" onclick="toggleSubmenu(this)">
                        <i class="fas fa-hard-hat"></i>
                        <span>Control Total de Obras</span>
                        <i class="fas fa-chevron-right arrow"></i>
                        <div class="menu-tooltip">Control Total de Obras</div>
                    </div>
                    <div class="submenu">
                        <a href="../cliente_control_obra/cliente_listado_obras_control.html" class="submenu-item">
                            <span class="full-text">Listado de Obras</span>
                            <span class="siglas">LO</span>
                            <div class="sigla-tooltip">Listado de Obras</div>
                        </a>
                    </div>
                </li>
                
                <!-- Configuración -->
                <li class="menu-item">
                    <div class="menu-header" onclick="toggleSubmenu(this)">
                        <i class="fas fa-cog"></i>
                        <span>Configuración</span>
                        <i class="fas fa-chevron-right arrow"></i>
                        <div class="menu-tooltip">Configuración</div>
                    </div>
                    <div class="submenu">
                        <a href="../cliente_configuracion/cliente_listado_obras.html" class="submenu-item">
                            <span class="full-text">Administración de Obras / Proyectos</span>
                            <span class="siglas">AOP</span>
                            <div class="sigla-tooltip">Administración de Obras / Proyectos</div>
                        </a>
                        <a href="../cliente_configuracion/cliente_listado_usuarios.html" class="submenu-item">
                            <span class="full-text">Administración de Usuarios</span>
                            <span class="siglas">AU</span>
                            <div class="sigla-tooltip">Administración de Usuarios</div>
                        </a>
                    </div>
                </li>
            </ul>
        </nav>
        
        <!-- Toggle Button (fuera del sidebar) -->
        <div class="sidebar-toggle" onclick="toggleSidebar()">
            <i class="fas fa-chevron-left"></i>
        </div>

        <main class="content">
            <!-- Breadcrumb -->
            <div class="breadcrumb">
                <div class="breadcrumb-item"><a href="../cliente_dashboard.html">Inicio</a></div>
                <div class="breadcrumb-item"><a href="#">Solicitudes y Cotizaciones</a></div>
                <div class="breadcrumb-item"><a href="cliente_listado_solicitudes.html">Listado de Solicitudes</a></div>
                <div class="breadcrumb-item"><a href="#" onclick="goBackToSolicitud()">Detalle Solicitud de Pedido</a></div>
                <div class="breadcrumb-item active">Cuadro Comparativo</div>
            </div>

            <h1 class="page-title">Cuadro Comparativo de Cotizaciones</h1>

            <!-- Header Information -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Información General</h2>
                    <span class="status-badge status-pending" id="statusBadge">PENDIENTE SELECCIÓN</span>
                </div>
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">Solicitud:</span>
                        <span class="info-value" id="numeroSolicitud">SOL-2025-0847</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Obra:</span>
                        <span class="info-value" id="obraNombre">EDIFICIO PACIFIC BLUE</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Fecha:</span>
                        <span class="info-value" id="fechaComparativo">15/06/2025</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Cotizaciones:</span>
                        <span class="info-value" id="numeroCotizaciones">3 Proveedores</span>
                    </div>
                </div>
            </div>

            <!-- Controls Card -->
            <div class="card">
                <!-- Process Information -->
                <div style="background-color: #e0e7ff; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <h3 style="font-size: 1rem; margin-bottom: 10px; color: var(--primary-color);">
                        <i class="fas fa-info-circle"></i> Proceso de Selección
                    </h3>
                    <ol style="margin: 0; padding-left: 20px; font-size: 0.9rem; line-height: 1.6;">
                        <li>Revise y compare las cotizaciones de los diferentes proveedores</li>
                        <li>Seleccione los productos y proveedores de su preferencia</li>
                        <li>Envíe su recomendación a SSL</li>
                        <li>SSL generará la cotización oficial basada en su selección</li>
                        <li>Recibirá la cotización oficial para su aprobación final</li>
                    </ol>
                </div>

                <div class="alert">
                    <i class="fas fa-info-circle"></i>
                    <span>Seleccione los productos y proveedores de su preferencia. Esta selección es una <strong>recomendación</strong> que será evaluada por SSL para generar la cotización oficial. La selección inicial muestra el <strong>mejor precio</strong> para cada producto, pero puede cambiarla según sus criterios (calidad, plazo de entrega, marca, etc.). Se pueden conformar una o varias órdenes de compra según los proveedores seleccionados.</span>
                </div>

                <div class="alert" style="background-color: #fef3c7; border-left-color: var(--warning-color);">
                    <i class="fas fa-exclamation-triangle" style="color: var(--warning-color);"></i>
                    <span>Las unidades de medida han sido normalizadas para una comparación equitativa. Los valores originales se muestran al pasar el cursor sobre cada ítem.</span>
                </div>

                <div class="view-controls">
                    <button class="view-btn active" onclick="changeView('comparison')">
                        <i class="fas fa-table"></i> Vista Comparativa
                    </button>
                    <button class="view-btn" onclick="changeView('individual')">
                        <i class="fas fa-file-alt"></i> Cotizaciones Individuales
                    </button>
                    <button class="view-btn" onclick="changeView('analysis')">
                        <i class="fas fa-chart-bar"></i> Análisis de Precios
                    </button>
                </div>

                <div class="filter-section">
                    <div class="filter-group">
                        <label>Criterio de Comparación</label>
                        <select class="filter-control" id="criteriaSelect" onchange="updateComparison()">
                            <option value="price">Mejor Precio</option>
                            <option value="delivery">Menor Plazo de Entrega</option>
                            <option value="quality">Calidad Certificada</option>
                            <option value="combined">Evaluación Combinada</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Mostrar Proveedores</label>
                        <select class="filter-control" id="providerFilter" onchange="filterProviders()">
                            <option value="all">Todos</option>
                            <option value="complete">Solo cotizaciones completas</option>
                            <option value="recommended">Recomendados por SSL</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Agrupar Productos</label>
                        <select class="filter-control" id="groupingSelect" onchange="updateGrouping()">
                            <option value="none">Sin agrupar</option>
                            <option value="category">Por categoría</option>
                            <option value="similarity">Por similitud</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Provider Summary -->
            <div class="card">
                <h2 class="card-title" style="margin-bottom: 20px;">Resumen de Proveedores</h2>
                
                <div class="provider-summary">
                    <div class="provider-card recommended">
                        <div class="provider-header">
                            <span class="provider-name">FERRETERÍA CENTRAL</span>
                            <span class="recommended-badge">RECOMENDADO</span>
                        </div>
                        <div class="provider-details">
                            <div class="detail-row">
                                <span class="detail-label">Total cotizado:</span>
                                <span class="detail-value">$3,087,500</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Items cotizados:</span>
                                <span class="detail-value">5/5 (100%)</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Plazo promedio:</span>
                                <span class="detail-value">3 días</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Validez cotización:</span>
                                <span class="detail-value">30 días</span>
                            </div>
                        </div>
                    </div>

                    <div class="provider-card">
                        <div class="provider-header">
                            <span class="provider-name">DISTRIBUIDORA ELÉCTRICA</span>
                        </div>
                        <div class="provider-details">
                            <div class="detail-row">
                                <span class="detail-label">Total cotizado:</span>
                                <span class="detail-value">$3,000,000</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Items cotizados:</span>
                                <span class="detail-value">5/5 (100%)</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Plazo promedio:</span>
                                <span class="detail-value">5 días</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Validez cotización:</span>
                                <span class="detail-value">30 días</span>
                            </div>
                        </div>
                    </div>

                    <div class="provider-card">
                        <div class="provider-header">
                            <span class="provider-name">MATERIALES DEL SUR</span>
                        </div>
                        <div class="provider-details">
                            <div class="detail-row">
                                <span class="detail-label">Total cotizado:</span>
                                <span class="detail-value">$2,205,000</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Items cotizados:</span>
                                <span class="detail-value">4/5 (80%)</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Plazo promedio:</span>
                                <span class="detail-value">2 días</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Validez cotización:</span>
                                <span class="detail-value">15 días</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Comparison Table -->
            <div class="card">
                <h2 class="card-title" style="margin-bottom: 20px;">Selección de Proveedores por Producto</h2>
                
                <!-- Legend -->
                <div style="display: flex; gap: 20px; margin-bottom: 15px; font-size: 0.85rem;">
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <div style="width: 20px; height: 20px; background-color: var(--best-price); border: 1px solid #ccc; border-radius: 4px;"></div>
                        <span>Mejor precio</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <div style="width: 20px; height: 20px; background-color: rgba(224, 231, 255, 0.5); border: 1px solid #ccc; border-radius: 4px;"></div>
                        <span>Proveedor seleccionado</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <input type="radio" checked disabled style="margin: 0;">
                        <span>Selección inicial: mejor precio</span>
                    </div>
                </div>
                
                <!-- Purchase Orders Preview -->
                <div id="ordersPreview" style="background-color: #f0f4f8; padding: 15px; border-radius: 8px; margin-bottom: 20px; display: none;">
                    <h3 style="font-size: 1.1rem; margin-bottom: 10px; color: var(--primary-color);">
                        <i class="fas fa-shopping-cart"></i> Órdenes de Compra Potenciales según su selección:
                    </h3>
                    <div id="ordersPreviewContent" style="display: grid; gap: 10px;">
                        <!-- Dynamic content will be inserted here -->
                    </div>
                </div>
                
                <div class="table-container">
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th rowspan="2">Código</th>
                                <th rowspan="2">Descripción</th>
                                <th rowspan="2">Cantidad</th>
                                <th rowspan="2">Unidad</th>
                                <th colspan="5" style="text-align: center; background-color: #e0f2fe;">FERRETERÍA CENTRAL</th>
                                <th colspan="5" style="text-align: center;">DISTRIBUIDORA ELÉCTRICA</th>
                                <th colspan="5" style="text-align: center;">MATERIALES DEL SUR</th>
                            </tr>
                            <tr>
                                <th>Selección</th>
                                <th>Precio Unit.</th>
                                <th>Total</th>
                                <th>Plazo</th>
                                <th>Marca</th>
                                <th>Selección</th>
                                <th>Precio Unit.</th>
                                <th>Total</th>
                                <th>Plazo</th>
                                <th>Marca</th>
                                <th>Selección</th>
                                <th>Precio Unit.</th>
                                <th>Total</th>
                                <th>Plazo</th>
                                <th>Marca</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Grupo Materiales Eléctricos -->
                            <tr class="product-group">
                                <td colspan="19">MATERIALES ELÉCTRICOS</td>
                            </tr>
                            <tr>
                                <td class="product-code">EL-1245</td>
                                <td>
                                    Cable eléctrico NYY 3x10mm2 0.6/1kV
                                    <span class="tooltip">
                                        <i class="fas fa-info-circle" style="color: var(--secondary-color); font-size: 0.75rem;"></i>
                                        <span class="tooltiptext">Normalizado de metros a metros lineales</span>
                                    </span>
                                </td>
                                <td style="text-align: center;">500</td>
                                <td style="text-align: center;">ML</td>
                                <!-- Ferretería Central -->
                                <td class="checkbox-cell">
                                    <input type="radio" name="product-EL-1245" class="provider-radio" data-product="EL-1245" data-provider="1" data-price="1600000">
                                </td>
                                <td class="price-cell">$3,200</td>
                                <td class="price-cell">$1,600,000</td>
                                <td style="text-align: center;">3 días</td>
                                <td style="text-align: center;">NEXANS</td>
                                <!-- Distribuidora Eléctrica -->
                                <td class="checkbox-cell">
                                    <input type="radio" name="product-EL-1245" class="provider-radio" data-product="EL-1245" data-provider="2" data-price="1575000" checked>
                                </td>
                                <td class="price-cell best-price">
                                    $3,150
                                    <div class="price-variation variation-down">
                                        <i class="fas fa-arrow-down"></i> -1.6%
                                    </div>
                                </td>
                                <td class="price-cell best-price">$1,575,000</td>
                                <td style="text-align: center;">5 días</td>
                                <td style="text-align: center;">CABLEC</td>
                                <!-- Materiales del Sur -->
                                <td class="checkbox-cell">
                                    <input type="radio" name="product-EL-1245" class="provider-radio" data-product="EL-1245" data-provider="3" data-price="1700000">
                                </td>
                                <td class="price-cell">$3,400</td>
                                <td class="price-cell">$1,700,000</td>
                                <td style="text-align: center;">2 días</td>
                                <td style="text-align: center;">NEXANS</td>
                            </tr>
                            <tr>
                                <td class="product-code">EL-0876</td>
                                <td>
                                    Tubo Conduit PVC 25mm
                                    <span class="unit-normalized">UN → TRA (6 UN)</span>
                                </td>
                                <td style="text-align: center;">50</td>
                                <td style="text-align: center;">TRA</td>
                                <!-- Ferretería Central -->
                                <td class="checkbox-cell">
                                    <input type="radio" name="product-EL-0876" class="provider-radio" data-product="EL-0876" data-provider="1" data-price="555000">
                                </td>
                                <td class="price-cell">$11,100</td>
                                <td class="price-cell">$555,000</td>
                                <td style="text-align: center;">2 días</td>
                                <td style="text-align: center;">TIGRE</td>
                                <!-- Distribuidora Eléctrica -->
                                <td class="checkbox-cell">
                                    <input type="radio" name="product-EL-0876" class="provider-radio" data-product="EL-0876" data-provider="2" data-price="534000" checked>
                                </td>
                                <td class="price-cell best-price">
                                    $10,680
                                    <div class="price-variation variation-down">
                                        <i class="fas fa-arrow-down"></i> -3.8%
                                    </div>
                                </td>
                                <td class="price-cell best-price">$534,000</td>
                                <td style="text-align: center;">3 días</td>
                                <td style="text-align: center;">DURATEC</td>
                                <!-- Materiales del Sur -->
                                <td class="checkbox-cell">
                                    <input type="radio" name="product-EL-0876" class="provider-radio" data-product="EL-0876" data-provider="3" data-price="570000">
                                </td>
                                <td class="price-cell">$11,400</td>
                                <td class="price-cell">$570,000</td>
                                <td style="text-align: center;">1 día</td>
                                <td style="text-align: center;">TIGRE</td>
                            </tr>
                            <tr>
                                <td class="product-code">EL-2534</td>
                                <td>Caja de derivación PVC 100x100mm</td>
                                <td style="text-align: center;">150</td>
                                <td style="text-align: center;">UN</td>
                                <!-- Ferretería Central -->
                                <td class="checkbox-cell">
                                    <input type="radio" name="product-EL-2534" class="provider-radio" data-product="EL-2534" data-provider="1" data-price="187500" checked>
                                </td>
                                <td class="price-cell best-price">
                                    $1,250
                                    <div class="price-variation variation-equal">
                                        <i class="fas fa-equals"></i> 0%
                                    </div>
                                </td>
                                <td class="price-cell best-price">$187,500</td>
                                <td style="text-align: center;">1 día</td>
                                <td style="text-align: center;">BTICINO</td>
                                <!-- Distribuidora Eléctrica -->
                                <td class="checkbox-cell">
                                    <input type="radio" name="product-EL-2534" class="provider-radio" data-product="EL-2534" data-provider="2" data-price="192000">
                                </td>
                                <td class="price-cell">$1,280</td>
                                <td class="price-cell">$192,000</td>
                                <td style="text-align: center;">2 días</td>
                                <td style="text-align: center;">LEGRAND</td>
                                <!-- Materiales del Sur -->
                                <td class="checkbox-cell">
                                    <input type="radio" name="product-EL-2534" class="provider-radio" data-product="EL-2534" data-provider="3" data-price="195000">
                                </td>
                                <td class="price-cell">$1,300</td>
                                <td class="price-cell">$195,000</td>
                                <td style="text-align: center;">1 día</td>
                                <td style="text-align: center;">BTICINO</td>
                            </tr>

                            <!-- Grupo Protecciones Eléctricas -->
                            <tr class="product-group">
                                <td colspan="19">PROTECCIONES ELÉCTRICAS</td>
                            </tr>
                            <tr>
                                <td class="product-code">EL-3698</td>
                                <td>
                                    Interruptor Diferencial 25A
                                    <span class="tooltip">
                                        <i class="fas fa-exclamation-triangle" style="color: var(--warning-color); font-size: 0.75rem;"></i>
                                        <span class="tooltiptext">Productos similares agrupados</span>
                                    </span>
                                </td>
                                <td style="text-align: center;">50</td>
                                <td style="text-align: center;">UN</td>
                                <!-- Ferretería Central -->
                                <td class="checkbox-cell">
                                    <input type="radio" name="product-EL-3698" class="provider-radio" data-product="EL-3698" data-provider="1" data-price="625000">
                                </td>
                                <td class="price-cell">$12,500</td>
                                <td class="price-cell">$625,000</td>
                                <td style="text-align: center;">2 días</td>
                                <td style="text-align: center;">SCHNEIDER</td>
                                <!-- Distribuidora Eléctrica -->
                                <td class="checkbox-cell">
                                    <input type="radio" name="product-EL-3698" class="provider-radio" data-product="EL-3698" data-provider="2" data-price="610000" checked>
                                </td>
                                <td class="price-cell best-price">
                                    $12,200
                                    <div class="price-variation variation-down">
                                        <i class="fas fa-arrow-down"></i> -2.4%
                                    </div>
                                </td>
                                <td class="price-cell best-price">$610,000</td>
                                <td style="text-align: center;">3 días</td>
                                <td style="text-align: center;">ABB</td>
                                <!-- Materiales del Sur -->
                                <td class="checkbox-cell">
                                    <input type="radio" name="product-EL-3698" class="provider-radio" data-product="EL-3698" data-provider="3" data-price="640000">
                                </td>
                                <td class="price-cell">$12,800</td>
                                <td class="price-cell">$640,000</td>
                                <td style="text-align: center;">1 día</td>
                                <td style="text-align: center;">LEGRAND</td>
                            </tr>
                            <tr class="incomplete-quote">
                                <td class="product-code">EL-4102</td>
                                <td>Terminal de conexión 10mm²</td>
                                <td style="text-align: center;">200</td>
                                <td style="text-align: center;">UN</td>
                                <!-- Ferretería Central -->
                                <td class="checkbox-cell">
                                    <input type="radio" name="product-EL-4102" class="provider-radio" data-product="EL-4102" data-provider="1" data-price="70000">
                                </td>
                                <td class="price-cell">$350</td>
                                <td class="price-cell">$70,000</td>
                                <td style="text-align: center;">1 día</td>
                                <td style="text-align: center;">3M</td>
                                <!-- Distribuidora Eléctrica -->
                                <td class="checkbox-cell">
                                    <input type="radio" name="product-EL-4102" class="provider-radio" data-product="EL-4102" data-provider="2" data-price="64000" checked>
                                </td>
                                <td class="price-cell best-price">
                                    $320
                                    <div class="price-variation variation-down">
                                        <i class="fas fa-arrow-down"></i> -8.6%
                                    </div>
                                </td>
                                <td class="price-cell best-price">$64,000</td>
                                <td style="text-align: center;">2 días</td>
                                <td style="text-align: center;">BURNDY</td>
                                <!-- Materiales del Sur -->
                                <td colspan="5" class="no-quote" style="text-align: center; background-color: #f8d7da;">
                                    <i class="fas fa-times-circle"></i> No cotizado
                                </td>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="4" style="text-align: right; font-weight: 600;">TOTAL SELECCIONADO:</td>
                                <td colspan="3" style="text-align: center; font-weight: 600;" id="totalProvider1">$187,500</td>
                                <td colspan="2"></td>
                                <td colspan="3" style="text-align: center; font-weight: 600;" id="totalProvider2">$2,783,000</td>
                                <td colspan="2"></td>
                                <td colspan="3" style="text-align: center; font-weight: 600;" id="totalProvider3">$0</td>
                                <td colspan="2"></td>
                            </tr>
                            <tr>
                                <td colspan="4" style="text-align: right; font-weight: 600;">TOTAL RECOMENDADO:</td>
                                <td colspan="15" style="text-align: center; font-size: 1.125rem; font-weight: 700; color: var(--primary-color);">
                                    <span id="totalOptimized">$2,970,500</span>
                                    <div style="font-size: 0.75rem; font-weight: normal; color: #666; margin-top: 4px;">
                                        (Basado en su selección actual)
                                    </div>
                                </td>
                            </tr>
                        </tfoot>
                    </table>
                </div>

                <div class="action-buttons">
                    <div class="btn-group">
                        <button class="btn btn-outline" onclick="goBackToSolicitud()">
                            <i class="fas fa-arrow-left"></i> Volver
                        </button>
                        <button class="btn btn-outline" onclick="exportToExcel()">
                            <i class="fas fa-file-excel"></i> Exportar Excel
                        </button>
                        <button class="btn btn-outline" onclick="printComparison()">
                            <i class="fas fa-print"></i> Imprimir
                        </button>
                    </div>
                    <div class="btn-group">
                        <button class="btn btn-primary" onclick="saveRecommendation()" id="saveBtn">
                            <i class="fas fa-bookmark"></i> Guardar Recomendación
                        </button>
                        <button class="btn btn-success" onclick="sendRecommendation()" id="sendBtn">
                            <i class="fas fa-paper-plane"></i> Enviar Recomendación a SSL
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Individual Quotation Modal -->
    <div id="quotationModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Cotización - FERRETERÍA CENTRAL</h2>
                <span class="close" onclick="closeModal()">&times;</span>
            </div>
            <div class="modal-body">
                <!-- Quotation details will be loaded here -->
            </div>
        </div>
    </div>

    <script>
        // Check if quotations are finalized
        const isFinalized = false; // This would come from backend
        
        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            loadUserData();
            loadComparisonData();
            updateDate();
            loadSidebarState();
            
            // Check if quotations are finalized
            if (isFinalized) {
                setReadOnlyMode();
            }
            
            // Update totals based on initial selections
            updateTotals();
            
            // Add event listeners to radio buttons
            document.querySelectorAll('.provider-radio').forEach(radio => {
                radio.addEventListener('change', function() {
                    updateTotals();
                    highlightSelectedProvider(this);
                });
                // Highlight initially selected providers
                if (radio.checked) {
                    highlightSelectedProvider(radio);
                }
            });
            
            // Update date every minute
            setInterval(updateDate, 60000);
        });

        // Toggle sidebar collapse
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const toggleButton = document.querySelector('.sidebar-toggle');
            const isCollapsed = sidebar.classList.contains('collapsed');
            
            if (isCollapsed) {
                sidebar.classList.remove('collapsed');
                localStorage.setItem('sidebarCollapsed', 'false');
            } else {
                sidebar.classList.add('collapsed');
                localStorage.setItem('sidebarCollapsed', 'true');
            }
            
            // Update button icon rotation
            const icon = toggleButton.querySelector('i');
            if (sidebar.classList.contains('collapsed')) {
                icon.style.transform = 'rotate(180deg)';
            } else {
                icon.style.transform = 'rotate(0deg)';
            }
        }

        // Load sidebar state from localStorage
        function loadSidebarState() {
            const isCollapsed = localStorage.getItem('sidebarCollapsed') === 'true';
            const sidebar = document.getElementById('sidebar');
            const toggleButton = document.querySelector('.sidebar-toggle');
            const icon = toggleButton.querySelector('i');
            
            if (isCollapsed) {
                sidebar.classList.add('collapsed');
                icon.style.transform = 'rotate(180deg)';
            }
        }

        // Toggle mobile menu
        function toggleMobileMenu() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('active');
        }

        // Toggle submenu
        function toggleSubmenu(header) {
            const menuItem = header.parentElement;
            const sidebar = document.getElementById('sidebar');
            const wasActive = menuItem.classList.contains('active');
            
            // If sidebar is collapsed and clicking on item with submenu, don't expand sidebar
            // Just toggle the submenu
            
            // Close all submenus
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Remove active from all headers
            document.querySelectorAll('.menu-header').forEach(h => {
                h.classList.remove('active');
            });
            
            // If it wasn't active, open it
            if (!wasActive && header.nextElementSibling) {
                menuItem.classList.add('active');
            }
            
            // Always keep the clicked header active if it's a main item
            if (!header.querySelector('.arrow')) {
                header.classList.add('active');
            }
        }

        // User menu dropdown
        const userMenu = document.getElementById('userMenu');
        let isUserMenuOpen = false;

        userMenu.addEventListener('click', function(e) {
            e.stopPropagation();
            isUserMenuOpen = !isUserMenuOpen;
            this.classList.toggle('active');
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
            if (!userMenu.contains(e.target) && isUserMenuOpen) {
                userMenu.classList.remove('active');
                isUserMenuOpen = false;
            }
        });

        // Update date
        function updateDate() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            };
            const formattedDate = now.toLocaleDateString('es-CL', options);
            const capitalizedDate = formattedDate.charAt(0).toUpperCase() + formattedDate.slice(1);
            
            document.getElementById('currentDate').textContent = capitalizedDate;
        }

        // Load user data
        function loadUserData() {
            const userData = sessionStorage.getItem('userData');
            if (userData) {
                try {
                    const data = JSON.parse(userData);
                    if (data.name) {
                        document.getElementById('userName').textContent = data.name;
                        document.getElementById('dropdownUserName').textContent = data.name;
                    }
                    if (data.email) {
                        document.getElementById('dropdownUserEmail').textContent = data.email;
                    }
                } catch (e) {
                    console.error('Error loading user data:', e);
                }
            }
        }

        // Load comparison data
        function loadComparisonData() {
            const urlParams = new URLSearchParams(window.location.search);
            const solicitud = urlParams.get('solicitud');
            
            if (solicitud) {
                document.getElementById('numeroSolicitud').textContent = solicitud;
            }
            
            // Load comparison data from sessionStorage
            const comparisonData = sessionStorage.getItem('comparisonData');
            if (comparisonData) {
                try {
                    const data = JSON.parse(comparisonData);
                    if (data.obra) {
                        document.getElementById('obraNombre').textContent = data.obra;
                    }
                    if (data.fecha) {
                        document.getElementById('fechaComparativo').textContent = data.fecha;
                    }
                    // You can load more data as needed
                } catch (e) {
                    console.error('Error loading comparison data:', e);
                }
            }
        }

        // Profile function
        function goToProfile(e) {
            e.preventDefault();
            alert('Navegando al perfil...\nEsta funcionalidad estará disponible próximamente.');
            userMenu.classList.remove('active');
            isUserMenuOpen = false;
        }

        // Settings function
        function goToSettings(e) {
            e.preventDefault();
            alert('Navegando a configuración...\nEsta funcionalidad estará disponible próximamente.');
            userMenu.classList.remove('active');
            isUserMenuOpen = false;
        }

        // Logout function
        function logout(e) {
            e.preventDefault();
            if (confirm('¿Está seguro que desea cerrar sesión?')) {
                localStorage.removeItem('clienteData');
                sessionStorage.clear();
                window.location.href = '../../index.html';
            }
        }

        // Show notifications
        function showNotifications() {
            alert('Panel de notificaciones\n\nEsta funcionalidad estará disponible próximamente.');
        }

        // Set read-only mode if quotations are finalized
        function setReadOnlyMode() {
            // Disable all radio buttons
            document.querySelectorAll('.provider-radio').forEach(radio => {
                radio.disabled = true;
            });
            
            // Update status badge
            document.getElementById('statusBadge').textContent = 'RECOMENDACIÓN ENVIADA';
            document.getElementById('statusBadge').className = 'status-badge status-recommendation';
            
            // Disable action buttons
            document.getElementById('saveBtn').disabled = true;
            document.getElementById('sendBtn').disabled = true;
        }

        // Highlight selected provider
        function highlightSelectedProvider(radio) {
            const row = radio.closest('tr');
            const provider = parseInt(radio.dataset.provider);
            
            // Remove all selected-provider classes from this row
            row.querySelectorAll('td').forEach(td => {
                td.classList.remove('selected-provider');
            });
            
            // Add selected-provider class to the selected provider's cells
            const startIndex = 4 + (provider - 1) * 5;
            for (let i = startIndex; i < startIndex + 5; i++) {
                if (row.cells[i]) {
                    row.cells[i].classList.add('selected-provider');
                }
            }
        }

        // Update totals based on selected items
        function updateTotals() {
            const providers = {
                1: { name: 'FERRETERÍA CENTRAL', total: 0, products: [] },
                2: { name: 'DISTRIBUIDORA ELÉCTRICA', total: 0, products: [] },
                3: { name: 'MATERIALES DEL SUR', total: 0, products: [] }
            };
            
            let totalOptimized = 0;
            
            // Price mapping for each product and provider
            const prices = {
                'EL-1245': { 1: 1600000, 2: 1575000, 3: 1700000, desc: 'Cable eléctrico NYY 3x10mm2' },
                'EL-0876': { 1: 555000, 2: 534000, 3: 570000, desc: 'Tubo Conduit PVC 25mm' },
                'EL-2534': { 1: 187500, 2: 192000, 3: 195000, desc: 'Caja de derivación PVC' },
                'EL-3698': { 1: 625000, 2: 610000, 3: 640000, desc: 'Interruptor Diferencial 25A' },
                'EL-4102': { 1: 70000, 2: 64000, 3: 0, desc: 'Terminal de conexión 10mm²' }
            };
            
            // Calculate totals based on radio button selections
            document.querySelectorAll('.provider-radio:checked').forEach(radio => {
                const product = radio.dataset.product;
                const provider = parseInt(radio.dataset.provider);
                const price = parseInt(radio.dataset.price);
                
                if (price > 0) {
                    providers[provider].total += price;
                    providers[provider].products.push({
                        code: product,
                        desc: prices[product].desc,
                        price: price
                    });
                    totalOptimized += price;
                }
            });
            
            // Update display with currency formatting
            document.getElementById('totalProvider1').textContent = `${providers[1].total.toLocaleString('es-CL')}`;
            document.getElementById('totalProvider2').textContent = `${providers[2].total.toLocaleString('es-CL')}`;
            document.getElementById('totalProvider3').textContent = `${providers[3].total.toLocaleString('es-CL')}`;
            document.getElementById('totalOptimized').textContent = `${totalOptimized.toLocaleString('es-CL')}`;
            
            // Update purchase orders preview
            updateOrdersPreview(providers);
        }

        // Update purchase orders preview
        function updateOrdersPreview(providers) {
            const ordersPreview = document.getElementById('ordersPreview');
            const ordersContent = document.getElementById('ordersPreviewContent');
            
            // Clear previous content
            ordersContent.innerHTML = '';
            
            let hasOrders = false;
            
            // Create order preview for each provider with selected products
            Object.keys(providers).forEach(key => {
                const provider = providers[key];
                if (provider.products.length > 0) {
                    hasOrders = true;
                    const orderDiv = document.createElement('div');
                    orderDiv.style.cssText = 'background-color: white; padding: 12px; border-radius: 6px; border: 1px solid #e5e7eb;';
                    
                    orderDiv.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <strong style="color: var(--secondary-color);">${provider.name}</strong>
                            <span style="font-weight: 600;">${provider.total.toLocaleString('es-CL')}</span>
                        </div>
                        <div style="font-size: 0.85rem; color: #666;">
                            ${provider.products.length} producto(s) seleccionado(s)
                        </div>
                    `;
                    
                    ordersContent.appendChild(orderDiv);
                }
            });
            
            // Show/hide preview based on selections
            ordersPreview.style.display = hasOrders ? 'block' : 'none';
        }

        // Change view
        function changeView(view) {
            // Update active button
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.closest('.view-btn').classList.add('active');
            
            if (view === 'individual') {
                showIndividualQuotation();
            } else if (view === 'analysis') {
                showPriceAnalysis();
            }
        }

        // Show individual quotation
        function showIndividualQuotation() {
            alert('Mostrando cotizaciones individuales...\nEsta funcionalidad estará disponible próximamente.');
        }

        // Show price analysis
        function showPriceAnalysis() {
            alert('Mostrando análisis de precios...\nEsta funcionalidad incluirá gráficos comparativos.');
        }

        // Update comparison based on criteria
        function updateComparison() {
            const criteria = document.getElementById('criteriaSelect').value;
            console.log('Updating comparison with criteria:', criteria);
            // Implementation would reorder/highlight based on criteria
        }

        // Filter providers
        function filterProviders() {
            const filter = document.getElementById('providerFilter').value;
            console.log('Filtering providers:', filter);
            // Implementation would show/hide providers based on filter
        }

        // Update grouping
        function updateGrouping() {
            const grouping = document.getElementById('groupingSelect').value;
            console.log('Updating grouping:', grouping);
            // Implementation would reorganize table based on grouping
        }

        // Save recommendation
        function saveRecommendation() {
            if (isFinalized) {
                alert('La recomendación ya ha sido enviada y no puede modificarse.');
                return;
            }
            
            const selectedItems = [];
            let hasSelection = false;
            
            document.querySelectorAll('.provider-radio:checked').forEach(radio => {
                hasSelection = true;
                selectedItems.push({
                    product: radio.dataset.product,
                    provider: radio.dataset.provider,
                    price: radio.dataset.price
                });
            });
            
            if (!hasSelection) {
                alert('Por favor seleccione al menos un producto antes de guardar.');
                return;
            }
            
            console.log('Saving recommendation:', selectedItems);
            alert('Recomendación guardada exitosamente.\n\nSu selección ha sido guardada como borrador y puede continuar modificándola.');
        }

        // Send recommendation to SSL
        function sendRecommendation() {
            if (isFinalized) {
                alert('La recomendación ya ha sido enviada.');
                return;
            }
            
            const selectedItems = [];
            let hasSelection = false;
            const providerCount = new Set();
            
            document.querySelectorAll('.provider-radio:checked').forEach(radio => {
                hasSelection = true;
                const provider = radio.dataset.provider;
                providerCount.add(provider);
                selectedItems.push({
                    product: radio.dataset.product,
                    provider: provider,
                    price: radio.dataset.price
                });
            });
            
            if (!hasSelection) {
                alert('Por favor seleccione al menos un producto antes de enviar su recomendación.');
                return;
            }
            
            const message = `¿Está seguro de enviar su recomendación a SSL?\n\n` +
                          `Ha seleccionado ${selectedItems.length} producto(s) de ${providerCount.size} proveedor(es).\n\n` +
                          `SSL evaluará su recomendación y generará la cotización oficial. ` +
                          `Se crearán ${providerCount.size} orden(es) de compra según los proveedores seleccionados.\n\n` +
                          `Una vez enviada, no podrá modificar esta recomendación.`;
            
            if (confirm(message)) {
                // This would send recommendation to backend
                alert('Recomendación enviada exitosamente.\n\n' +
                      'SSL revisará su selección y generará:\n' +
                      '• La cotización oficial para su aprobación\n' +
                      `• ${providerCount.size} orden(es) de compra a proveedor(es)\n\n` +
                      'Recibirá una notificación cuando la cotización oficial esté lista.');
                setReadOnlyMode();
            }
        }

        // Export to Excel
        function exportToExcel() {
            alert('Exportando cuadro comparativo a Excel...\n\nEl archivo se descargará en breve.');
        }

        // Print comparison
        function printComparison() {
            window.print();
        }

        // Go back to solicitud
        function goBackToSolicitud() {
            const solicitud = document.getElementById('numeroSolicitud').textContent;
            window.location.href = `cliente_detalle_solicitud.html?numero=${solicitud}`;
        }

        // Close modal
        function closeModal() {
            document.getElementById('quotationModal').style.display = 'none';
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        }

        // Keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeModal();
                if (isUserMenuOpen) {
                    userMenu.classList.remove('active');
                    isUserMenuOpen = false;
                }
            }
        });
    </script>
</body>
</html>